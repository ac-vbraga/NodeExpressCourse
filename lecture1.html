<!DOCTYPE HTML>
<!--
Read Only by HTML5 UP
html5up.net | @n33co
Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
  <head>
    <title>Node 4: ES6 e o que você esta fazendo de errado</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
    <script src="js/jquery.min.js"></script>
    <script src="js/jquery.scrollzer.min.js"></script>
    <script src="js/jquery.scrolly.min.js"></script>
    <script src="js/skel.min.js"></script>
    <script src="js/skel-layers.min.js"></script>
    <script src="js/init.js"></script>

    <noscript>
      <link rel="stylesheet" href="css/skel.css" />
      <link rel="stylesheet" href="css/style.css" />
      <link rel="stylesheet" href="css/style-xlarge.css" />
    </noscript>

    <style>
    .img-caption {
      margin: 5px 0px 10px 0px;
      font-size: 13px;
      text-align: center;
    }

    #header > nav ul li a {
      padding: 0px;
      font-size: 0.8em;
    }

    #one:before {
      background-image: none;
      height: 0em;
    }

    header.major h2 {
      line-height: 1em;
    }
    </style>

    <!--[if lte IE 8]><link rel="stylesheet" href="css/ie/v8.css" /><![endif]-->
  </head>
  <body>
    <div id="wrapper">

      <!-- Header -->
      <section id="header" class="skel-layers-fixed">
        <header>
          <h1 id="logo"><a href="#">Node 4: ES6 e o que você esta fazendo de errado</a></h1>
        </header>

        <nav id="nav">
          <ul>
            <li><a href="#one" class="active">O que há de novo no Node 4.0.0?</a></li>
            <li><a href="#two" class="active">ES6 em Node.js</a></li>
            <li><a href="#three" class="active">Down to business</a></li>
          </ul>
          <img src="http://www.avenuecode.com/wp-content/themes/ac-site/images/white-logo.png" alt="">
        </nav>
        
        <footer>
        </footer>
        
      </section>

      <!-- Main -->
      <div id="main">

        <!-- One -->
        <section id="one">
          <div class="container">
            <header class="major">
              <h2>O que há de novo no Node 4.0.0?</h2>
            </header>

            <p align="justify">
              A pouco tempo os desenvolvedores JavaScript foram agraciados pela presença do Node.js. Esse
              ambiente foi concebidos para que fosse possível construir aplicações desktop usando JavaScript.
            </p>

            <p align="justify">
              Entretando houve uma certa discussão sobre qual seria o melhor caminho a se trilhar com relação
              a certas features do projeto, assim foi criado o IO.js. Felizmente, após um certo tempo
              separados, os dois projetos foram fundidos, tornando-se um só novamente.
            </p>

            <p align="justify">
              Qual foi o benefício dessa fusão? O início da implementação do ECMAScript 6! Sim meus amigos,
              agora Node.js reconhece a sintaxe da nova versão do nosso amado JavaScript, mas infelizmente não
              toda. Não podemos deixar de falar do LTS (Long Term Support) que agora esta sendo realizado com
              as versões do Node, mas não é o foco dessa apresentação.
            </p>

            <header>
              <h4>Beleza, e dai?</h4>
            </header>

            <p align="justify">
              A primeira coisa que nos perguntamos, ou que pelo menos deveríamos, seria: <b>E dai?</b>
              Ora, caro colegua, com certeza essa nova sintaxe irá mudar em como programamos nossas
              aplicações para o Node! Mas, isso não é inteiramente verdade. Veremos a seguir que, mesmo
              com as novas funcionalidades, ainda manteremos praticamente todas as boas práticas que
              conhecemos para Node (Já que muitas delas são boas práticas de JavaScript).
            </p>
          </div>
        </section>

        <!-- Two -->
        <section id="two">
          <div class="container">
            <header class="major">
              <h2>ES6 em Node.js</h2>
            </header>

            <p align="justify">
              O que o Node 4 traz para os desenvolvedores de novo?
            </p>

            <ul>
              <li>
                Block scope
                <ul>
                  <li>let</li>
                  <li>const</li>
                  <li>function-in-blocks</li>
                </ul>
              </li>
              <li>Classes</li>
              <li>
                Collections
                <ul>
                  <li>Map</li>
                  <li>WeakMap</li>
                  <li>Set</li>
                  <li>WeakSet</li>
                </ul>
              </li>
              <li>Typed arrays</li>
              <li>Generators</li>
              <li>Binary and Octal literals</li>
              <li>Object literal extensions</li>
              <li>Promises</li>
              <li>New String methods</li>
              <li>Symbols</li>
              <li>Template strings</li>
              <li>Arrow Functions</li>
              <li>Object.assign</li>
            </ul>

            <p align="justify">
              Isso são somente as funcionalidades estáveis, ainda temos as que estão em teste e
              as que estão em desenvolvimento. Também temos que levar em consideração que o <i>let</i>
              e as <i>Classes</i> só funcionam sobre o escope de "use strict".
            </p>
          </div>
        </section>

        <!-- three -->
        <section id="three">
          <div class="container">
            <header class="major">
              <h2>Down to business</h2>
            </header>

            <header class="major">
              <h4>Promises</h2>
            </header>

            <p align="justify">
              Ok, primeiramente vamos falar de promises! Essa danadinha ai vai ser responsável pelas
              maiores mudanças aqui. Como somes desenvolvedores de JavaScript somos loucos por callbacks!
              Caramba, quantas vezes a gente fica passando callback pra cá, callback pra lá, e podemos até
              confundir as coisas e perguntar: <b>Caramba.... onde eu posso declarar esse callback?</b>
            </p>

            <p align="justify">
              Vamos lá, exemplo básico e clichê: Eu tenho aqui um servidor em Node e estou fazendo um
              controller que vai chamar a camada de dados para pegar uns dados. O problema que, como sabemos,
              Node é assíncrono então temos que passar as callbacks para a camada de baixo chama-las assim que
              terminatem de fazer suas ações:
            </p>

            <!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #f8f8f2">...</span>

<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">getUsers</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">function</span> <span style="color: #f8f8f2">(</span><span style="color: #a6e22e">req</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">res</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
  <span style="color: #66d9ef">var</span> <span style="color: #a6e22e">succ</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">function</span> <span style="color: #f8f8f2">(</span><span style="color: #a6e22e">data</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
    <span style="color: #a6e22e">res</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">json</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">data</span><span style="color: #f8f8f2">);</span>
  <span style="color: #f8f8f2">};</span>

  <span style="color: #66d9ef">var</span> <span style="color: #a6e22e">fail</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">function</span> <span style="color: #f8f8f2">(</span><span style="color: #a6e22e">error</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">status</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
    <span style="color: #a6e22e">res</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">status</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">status</span><span style="color: #f8f8f2">).</span><span style="color: #a6e22e">send</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">error</span><span style="color: #f8f8f2">);</span>
  <span style="color: #f8f8f2">}</span>

  <span style="color: #a6e22e">usersLayer</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">getUsers</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">succ</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">fail</span><span style="color: #f8f8f2">);</span>
<span style="color: #f8f8f2">}</span>

<span style="color: #f8f8f2">...</span>
</pre></div>
            <div class="img-caption">Péssimo exemplo de callback</div>

            <p align="justify">
              Dessa forma o getUsers da camada de dados seria algo do tipo:
            </p>

            <!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #f8f8f2">...</span>

<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">getUsers</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">function</span> <span style="color: #f8f8f2">(</span><span style="color: #a6e22e">succ</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">fail</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
  <span style="color: #a6e22e">mongoose</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">find</span><span style="color: #f8f8f2">({...},</span> <span style="color: #66d9ef">function</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">err</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">data</span><span style="color: #f8f8f2">){</span>
    <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(</span><span style="color: #a6e22e">err</span><span style="color: #f8f8f2">)</span> <span style="color: #a6e22e">fail</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">err</span><span style="color: #f8f8f2">);</span>
    <span style="color: #66d9ef">else</span> <span style="color: #a6e22e">succ</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">data</span><span style="color: #f8f8f2">);</span>
  <span style="color: #f8f8f2">});</span>
<span style="color: #f8f8f2">}</span>

<span style="color: #f8f8f2">...</span>
</pre></div>
            <div class="img-caption">Exemplo de uma camada de dados</div>

            <p align="justify">
              Gente...olha isso... vocês acham isso bom? Tipo, dá pra ler porque isso é algo pequeno e apenas
              para ilustrar. Tenho certeza que vocês já viram algo pior. Mas assim, a gente entende o que vai
              ser executado se tiver sucesso e se tiver falha, mas podemos ver que isso depende da organização
              do desenvolvedor (tudo depende neh? Mas tem como arrumarmos isso!).
            </p>

            <p align="justify">
              Agora vamos usar as promises, e vamos ver a mágica acontecendo.
            </p>

            <!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #f8f8f2">...</span>

<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">getUsers</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">function</span> <span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
  <span style="color: #66d9ef">return</span> <span style="color: #66d9ef">new</span> <span style="color: #a6e22e">Promise</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">function</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">fulfill</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">reject</span><span style="color: #f8f8f2">){</span>
    <span style="color: #a6e22e">mongoose</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">find</span><span style="color: #f8f8f2">({...},</span> <span style="color: #66d9ef">function</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">err</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">data</span><span style="color: #f8f8f2">){</span>
      <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(</span><span style="color: #a6e22e">err</span><span style="color: #f8f8f2">)</span> <span style="color: #a6e22e">reject</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">err</span><span style="color: #f8f8f2">);</span>
      <span style="color: #66d9ef">else</span> <span style="color: #a6e22e">fufill</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">data</span><span style="color: #f8f8f2">);</span>
    <span style="color: #f8f8f2">});</span>
  <span style="color: #f8f8f2">});</span>
<span style="color: #f8f8f2">}</span>

<span style="color: #f8f8f2">...</span>
</pre></div>
            <div class="img-caption">Promise na camada de Dado</div>

            <p align="justify">
              Praticamente não se muda nada aqui. Seis por meia dúzia. Mas só de colocar a promisse temos as seguintes
              melhoras:
            </p>

            <ul>
              <li>Assinatura do método não possui mais a necessidade de ter as callbacks, deixando mais limpo
              sua chamada;</li>
              <li>É criado um padrão de resposta para o sucesso e para a falha, assim temos menos problemas de
              um desenvolvedor qualquer fazer coisa errada e essa camada chamar uma função undefined;</li>
              <li>Isolamos o módulo tornando ele em uma camada de verdade. Ou seja, como seguimos o padrão
              de promisse podemos reusar melhor ainda o código sem o time ter que dissecar o que essa camada
              esta fazendo.</li>
            </ul>

            <p align="justify">
              Vamos ver nosso controller agora:
            </p>

            <!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #f8f8f2">...</span>

<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">getUsers</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">function</span> <span style="color: #f8f8f2">(</span><span style="color: #a6e22e">req</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">res</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
  <span style="color: #a6e22e">usersLayer</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">getUsers</span><span style="color: #f8f8f2">().</span><span style="color: #a6e22e">then</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">function</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">data</span><span style="color: #f8f8f2">){</span>
    <span style="color: #a6e22e">res</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">json</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">data</span><span style="color: #f8f8f2">);</span>
  <span style="color: #f8f8f2">}).</span><span style="color: #66d9ef">catch</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">function</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">error</span><span style="color: #f8f8f2">){</span>
    <span style="color: #a6e22e">res</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">status</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">error</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">status</span><span style="color: #f8f8f2">).</span><span style="color: #a6e22e">send</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">error</span><span style="color: #f8f8f2">);</span>
  <span style="color: #f8f8f2">});</span>
<span style="color: #f8f8f2">}</span>

<span style="color: #f8f8f2">...</span>
</pre></div>

            <div class="img-caption">Promise no controller</div>

            <p align="justify">
              Um método muito mais enxuto. Nos livramos das variáveis que guardavam as callbacks e deixamos a
              chamada da camada de dados muito mais limpa. Fica mais fácil de de entender o que esta acontecendo
              e quem realmente chama as funções de sucesso e falha é o controller. Isos porque as promises apenas
              sinalizam a forma como acabaram e o controller lida com elas. Fica mais claro o que esta acontecendo
              e também dá uma martelada final de quem é responsável em lidar com os dados e de como enviar para o 
              cliente.
            </p>

            <p align="justify">
              Alguém percebeu que isso confronta a regra <b>Error First</b>? Com as promises não precisamos de validar
              se existe o erro ou não, ela faz isso automáticamente com o reject (Não automáticamente, claro, mas por
              de baixo dos panos na perspectiva do controller).
            </p>

            <header class="major">
              <h4>Escopo</h2>
            </header>

            <p align="justify">
              Então, Node é bom de mais, contudo, temos o problema de que o V8 usa um GC guloso e preguiçoso. Ele tem
              um limite padrão de 1.5GB rodando em apenas um core. Por causa disso precisamos sempre ter em mente
              em criar aplicativos que tenham uma preocupação com a utilização de memória. Ai que entra os termos
              <b>const</b>, <b>let</b> e as <b>arrow functions</b>. Claro que uma boa estratégia de cluster ajuda
              bastante nisso, mas agora estamos falando de processos individuais. Vamos olhar o seguinte código:
            </p>

            <!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #66d9ef">for</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">var</span> <span style="color: #a6e22e">i</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">10</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">i</span><span style="color: #f92672">&gt;=</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">i</span><span style="color: #f92672">--</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
  <span style="color: #a6e22e">console</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">log</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&#39;opa&#39;</span><span style="color: #f8f8f2">);</span>
<span style="color: #f8f8f2">}</span>

<span style="color: #a6e22e">console</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">log</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">i</span><span style="color: #f8f8f2">);</span>
</pre></div>
            <div class="img-caption">Variável com visibilidade fora do for</div>

            <p align="justify">
              Como podemos ver esse código faz com que possa ser usado a variável fora do for, ou seja, mesmo depois que a
              a função da variável i já ter acabado, ela continua na memória. se possuíssemos uma porção de for rodando ao
              mesmo tempo, pode ser que nossa memória fique sobre carregada e nosso GC trabalhe bastante, diminuindo o
              desempenho da nossa aplicação. Assim sendo, usando o <b>let</b> sabemos que seu escopo não sai de dentro do
              for:
            </p>

            <!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #66d9ef">for</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">let</span> <span style="color: #a6e22e">i</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">10</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">i</span><span style="color: #f92672">&gt;=</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">i</span><span style="color: #f92672">--</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
  <span style="color: #a6e22e">console</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">log</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&#39;opa&#39;</span><span style="color: #f8f8f2">);</span>
<span style="color: #f8f8f2">}</span>

<span style="color: #a6e22e">console</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">log</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">i</span><span style="color: #f8f8f2">);</span>
</pre></div>

            <div class="img-caption">Variável sem visibilidade fora do for</div>

            <p align="justify">
              Agora a variável i tem seu escopo restrito dentro do for. Desse jeito evitamos também qualquer tipo de bug
              que poderia causar se por um acaso sobrescrevermos ou usarmos a variável i em algum momento. Mantendo o código limpo.
              Um pequeno exemplo prático:
            </p>

            <!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #e6db74">&#39;use strict&#39;</span><span style="color: #f8f8f2">;</span>

<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">EventEmitter</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">require</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&#39;events&#39;</span><span style="color: #f8f8f2">).</span><span style="color: #a6e22e">EventEmitter</span><span style="color: #f8f8f2">;</span>

<span style="color: #66d9ef">class</span> <span style="color: #a6e22e">Dog</span> <span style="color: #66d9ef">extends</span> <span style="color: #a6e22e">EventEmitter</span><span style="color: #f8f8f2">{</span>
  <span style="color: #a6e22e">constructor</span><span style="color: #f8f8f2">(){</span>
    <span style="color: #66d9ef">super</span><span style="color: #f8f8f2">();</span>
  <span style="color: #f8f8f2">}</span>
<span style="color: #f8f8f2">};</span>

<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">dogs</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span><span style="color: #66d9ef">new</span> <span style="color: #a6e22e">Dog</span><span style="color: #f8f8f2">(),</span> <span style="color: #66d9ef">new</span> <span style="color: #a6e22e">Dog</span><span style="color: #f8f8f2">(),</span> <span style="color: #66d9ef">new</span> <span style="color: #a6e22e">Dog</span><span style="color: #f8f8f2">(),</span> <span style="color: #66d9ef">new</span> <span style="color: #a6e22e">Dog</span><span style="color: #f8f8f2">()];</span>

<span style="color: #66d9ef">for</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">var</span> <span style="color: #a6e22e">i</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">3</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">i</span><span style="color: #f92672">&gt;=</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">i</span><span style="color: #f92672">--</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
  <span style="color: #a6e22e">dogs</span><span style="color: #f8f8f2">[</span><span style="color: #a6e22e">i</span><span style="color: #f8f8f2">].</span><span style="color: #a6e22e">on</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&#39;bark&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #66d9ef">function</span><span style="color: #f8f8f2">(){</span>
    <span style="color: #a6e22e">console</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">log</span><span style="color: #f8f8f2">(</span><span style="color: #960050; background-color: #1e0010">`</span><span style="color: #a6e22e">Barking</span> <span style="color: #a6e22e">at</span> <span style="color: #a6e22e">$</span><span style="color: #f8f8f2">{</span><span style="color: #a6e22e">i</span><span style="color: #f8f8f2">}</span><span style="color: #960050; background-color: #1e0010">`</span><span style="color: #f8f8f2">);</span>
  <span style="color: #f8f8f2">});</span>
<span style="color: #f8f8f2">}</span>

<span style="color: #a6e22e">dogs</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">forEach</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">function</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">element</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">index</span><span style="color: #f8f8f2">){</span>
  <span style="color: #a6e22e">element</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">emit</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&#39;bark&#39;</span><span style="color: #f8f8f2">);</span>
<span style="color: #f8f8f2">});</span>
</pre></div>

            <div class="img-caption">Definindo eventos com o escopo de var</div>

            <p align="justify">
              Executando esse código iremos ter um resultado de quatro -1 impessos no console. Mas, e se mudassemos para let
              o nosso for?
            </p>

            <!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #e6db74">&#39;use strict&#39;</span><span style="color: #f8f8f2">;</span>

<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">EventEmitter</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">require</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&#39;events&#39;</span><span style="color: #f8f8f2">).</span><span style="color: #a6e22e">EventEmitter</span><span style="color: #f8f8f2">;</span>

<span style="color: #66d9ef">class</span> <span style="color: #a6e22e">Dog</span> <span style="color: #66d9ef">extends</span> <span style="color: #a6e22e">EventEmitter</span><span style="color: #f8f8f2">{</span>
  <span style="color: #a6e22e">constructor</span><span style="color: #f8f8f2">(){</span>
    <span style="color: #66d9ef">super</span><span style="color: #f8f8f2">();</span>
  <span style="color: #f8f8f2">}</span>
<span style="color: #f8f8f2">};</span>

<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">dogs</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span><span style="color: #66d9ef">new</span> <span style="color: #a6e22e">Dog</span><span style="color: #f8f8f2">(),</span> <span style="color: #66d9ef">new</span> <span style="color: #a6e22e">Dog</span><span style="color: #f8f8f2">(),</span> <span style="color: #66d9ef">new</span> <span style="color: #a6e22e">Dog</span><span style="color: #f8f8f2">(),</span> <span style="color: #66d9ef">new</span> <span style="color: #a6e22e">Dog</span><span style="color: #f8f8f2">()];</span>

<span style="color: #66d9ef">for</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">let</span> <span style="color: #a6e22e">i</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">3</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">i</span><span style="color: #f92672">&gt;=</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">i</span><span style="color: #f92672">--</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
  <span style="color: #a6e22e">dogs</span><span style="color: #f8f8f2">[</span><span style="color: #a6e22e">i</span><span style="color: #f8f8f2">].</span><span style="color: #a6e22e">on</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&#39;bark&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #66d9ef">function</span><span style="color: #f8f8f2">(){</span>
    <span style="color: #a6e22e">console</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">log</span><span style="color: #f8f8f2">(</span><span style="color: #960050; background-color: #1e0010">`</span><span style="color: #a6e22e">Barking</span> <span style="color: #a6e22e">at</span> <span style="color: #a6e22e">$</span><span style="color: #f8f8f2">{</span><span style="color: #a6e22e">i</span><span style="color: #f8f8f2">}</span><span style="color: #960050; background-color: #1e0010">`</span><span style="color: #f8f8f2">);</span>
  <span style="color: #f8f8f2">});</span>
<span style="color: #f8f8f2">}</span>

<span style="color: #a6e22e">dogs</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">forEach</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">function</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">element</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">index</span><span style="color: #f8f8f2">){</span>
  <span style="color: #a6e22e">element</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">emit</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&#39;bark&#39;</span><span style="color: #f8f8f2">);</span>
<span style="color: #f8f8f2">});</span>
</pre></div>
            <div class="img-caption">Definindo eventos com o escopo de var</div>

            <p align="justify">
              Agora, cada evento estará atrelado ao escopo do let e podemos ter certeza que, ao emitirmos o evento bark
              teremos o valor correto sendo impresso.
            </p>



          </div>
        </section>
      </div>

      <!-- Footer -->
      <section id="footer">
        <div class="container">
          <ul class="copyright">
            <li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
          </ul>
        </div>
      </section>
    </div>
  </body>
</html>